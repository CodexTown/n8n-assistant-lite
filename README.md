<img src="https://raw.githubusercontent.com/CodexTown/n8n-assistant-lite/main/assets/codextown_assistant_header.png" width="800">

# Codex Town • Ai Assistant Light (n8n workflow)

Простой ИИ-ассистент, построенный на базе n8n, который интегрируется с Google Drive и Supabase для обработки документов и обеспечения интеллектуальных ответов на вопросы пользователей с использованием дополнительных источников знаний.

## Описание
Данный проект представляет собой ИИ-ассистента, который:

- Мониторит папку в Google Drive на предмет создания или обновления файлов.
- Загружает новые или обновленные файлы, извлекает из них текст и сохраняет его в Supabase в виде векторных эмбеддингов.
- Использует GPT-4 или локальную LLM для обработки запросов пользователей с возможностью обращаться к сохраненным документам и инструментам, таким как калькулятор.
- Хранит историю чата в базе данных Postgres для поддержания контекста беседы.

## Функциональность
- **Интеграция с Google Drive**: Автоматическое обнаружение и обработка новых или обновленных файлов в указанной папке.
- **Обработка документов**: Извлечение текста из документов, разбиение на части и создание эмбеддингов с помощью модели OpenAI.
- **Хранение данных**: Использование Supabase для хранения векторных эмбеддингов документов.
- **Интеллектуальные ответы**: Использование GPT-4 или локальной LLM для генерации ответов, включая доступ к дополнительным источникам знаний.
- **История чата**: Сохранение истории диалога в Postgres для поддержания контекста.
- **Инструменты**: Возможность подключения дополнительных инструментов, таких как калькулятор.

## Установка и настройка

### Предварительные требования

Для корректной работы ИИ-ассистент вам понадобится следующее:

- **n8n**: Установленный и настроенный на вашем сервере или локально. Также подойдет онлайн-версия.
- **Аккаунт Google Drive**: С папкой, предназначенной для загрузки документов.
- **Аккаунт Supabase**: Локальный или внешний с настроенной таблицей documents и возможностью хранения векторных эмбеддингов.
- **OpenAI API Key**: Необходим для использования моделей OpenAi. Не нужен при использовании локальных моделей (ollama).
- **Node.js и npm**: Для дополнительных скриптов или зависимостей (при необходимости).

### Шаги установки

1. Клонируйте репозиторий

```
git clone https://github.com/yourusername/your-repository.git
cd your-repository
```

2. Импортируйте workflow в n8n

- Откройте n8n Editor.
- Импортируйте файл workflow.json, расположенный в репозитории.

3. Настройте учетные данные в n8n

- Добавьте необходимые credentials для использования в n8n.

4. Обновите параметры workflow

- **ID папки Google Drive**. В узлах File Created и File Updated установите параметр folderToWatch на ID вашей папки в Google Drive.
- **Таблица Supabase**. Убедитесь, что узлы insertDocs2Supabase и match_documents указывают на правильную таблицу Supabase (documents).

## Использование

### Загрузка документов

- Добавьте или обновите файлы в указанной вами папке Google Drive.
- Поддерживаемые типы файлов включают Google Docs (конвертируются в простой текст).

- Workflow автоматически:
  - Обнаружит новый или обновленный файл.
  - Удалит устаревшие записи в Supabase.
  - Загрузит и извлечет текст из файла.
  - Разобьет текст и создаст эмбеддинги.
  - Сохранит эмбеддинги и метаданные в Supabase.

### Взаимодействие с ИИ-ассистентом

- Используйте узел Chat в n8n для ввода ваших запросов.

- Ассистент использует:
  - Модель GPT-4 (4o-mini узел) для генерации ответов.
  - Компонент памяти (chatLogs узел) для поддержания контекста.
  - Инструменты, такие как Calculator и user_documents, для расширенных возможностей.

  Ассистент будет извлекать релевантные документы из Supabase для предоставления информативных ответов.
